{% extends "layout.html" %}

{% block content %}

<div class="jumbotron">
    <h1 class="display-4">Level {{ data.level }}: {{ data.objective }}</h1>
    <hr class="my-4">
    <p>{{ data.question }}</p>
    <p> Mission: {{ data.description }}</p>
    
    {% if data.level == 1 %}
    <!-- File download link -->
    <a href="{{ data.file_link }}" class="btn btn-secondary" download>Download File</a>
    <br><br>

    <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
    Hint
    </button>
  
  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Hint</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <p>
                After downloading the file, follow these steps in your terminal:
                <ol>
                    <li><code>cd Downloads</code> - Navigate to your Downloads directory</li>
                    <li><code>ls</code> - List the files in the directory to ensure the file is there</li>
                    <li><code>cat level1_password.txt</code> - Display the contents of the file</li>
                </ol>
            </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

    {% if feedback %}
    <div class="alert alert-info">{{ feedback }}</div>
    {% endif %}
    
    <form method="POST">
        <div class="mb-3">
            <label for="player_input">Enter the encrypted password:</label>
            <input type="text" class="form-control" id="player_input" name="player_input" placeholder="Type your answer here">
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
    </form>

    {% elif data.level == 2 %}

    <a href="{{ data.file_link }}" class="btn btn-secondary" download>Download File</a>
    <br><br>
    <p>Once you have the password, go to <a href="https://gchq.github.io/CyberChef/" target="_blank">CyberChef</a> to decrypt it using ROT13.</p>
    
    <form method="POST">
        <div class="mb-3">
            <label for="player_input">Enter the decrypted password:</label>
            <input type="text" class="form-control" id="player_input" name="player_input" placeholder="Type your answer here">
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
    
    {% endif %}
</div>

{% endblock %}